<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Or√ßamento | Pena Planejados</title>

<link rel="icon" href="favicon.png">
<link rel="manifest" href="manifest.json">

<script src="https://cdn.tailwindcss.com"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

<script>
tailwind.config = {
  theme: {
    extend: {
      colors: {
        vinho: '#7a0f2b',
        cinza: '#e5e5e5'
      }
    }
  }
}
</script>

<style>
@page { size: A4; margin: 10mm; }

@media print {
  body { background: white; }
  .nao-imprimir { display: none !important; }
}

input:disabled { background:#f3f4f6 }
</style>
</head>

<body class="bg-gray-200 flex justify-center p-2 md:p-4">

<div id="orcamento" class="bg-white w-full md:w-[210mm] min-h-[297mm] text-sm">

<!-- CABE√áALHO -->
<header class="border-b-4 border-vinho p-4 md:p-6">
  <div class="flex flex-col md:flex-row md:justify-between md:items-center gap-4">
    
    <div class="flex justify-center md:justify-start">
      <img src="logo.png" class="w-40 md:w-56 object-contain">
    </div>

    <div class="text-center md:text-right text-sm">
      <p>Rua do Hospital s/n</p>
      <p>Santa Am√©lia ‚Äì Posto da Mata ‚Äì BA</p>
      <p><strong>Respons√°veis:</strong> Fl√°vio Pena e Gilm√°ria Pena</p>
      <p><strong>Contato:</strong> (73) 99959-4928 / (73) 99999-2026</p>
      <p id="dataAtual" class="text-vinho font-bold"></p>
    </div>

  </div>
</header>

<!-- DADOS -->
<section class="p-4 md:p-6">
  <h2 class="bg-cinza text-vinho font-bold px-4 py-2">DADOS PESSOAIS</h2>
  <div class="grid grid-cols-1 md:grid-cols-3 gap-3 mt-4">
    <input class="campo border p-2" placeholder="Cliente">
    <input class="campo border p-2" placeholder="Telefone">
    <input class="campo border p-2" placeholder="Endere√ßo">
  </div>
</section>

<!-- OR√áAMENTO -->
<section class="p-4 md:p-6">
  <h2 class="bg-cinza text-vinho font-bold px-4 py-2">OR√áAMENTO</h2>

  <div class="overflow-x-auto">
    <table class="w-full border mt-4">
      <thead class="bg-cinza text-vinho">
        <tr>
          <th class="border p-2">Descri√ß√£o</th>
          <th class="border p-2 w-16">Qtd</th>
          <th class="border p-2 w-24">√Ä Vista</th>
          <th class="border p-2 w-24">√Ä Prazo</th>
          <th class="border p-2 w-10 nao-imprimir">üóë</th>
        </tr>
      </thead>
      <tbody id="itens"></tbody>
      <tfoot>
        <tr>
          <td colspan="2" class="border p-2 text-right font-bold bg-cinza">TOTAL</td>
          <td id="totalVista" class="border p-2 font-bold">R$ 0,00</td>
          <td id="totalPrazo" class="border p-2 font-bold">R$ 0,00</td>
          <td class="border nao-imprimir"></td>
        </tr>
      </tfoot>
    </table>
  </div>

  <button onclick="addLinha()" class="nao-imprimir mt-4 bg-vinho text-white px-4 py-2 rounded w-full md:w-auto">
    Adicionar Item
  </button>
</section>

<!-- OBS -->
<section class="p-4 md:p-6">
  <h2 class="bg-cinza text-vinho font-bold px-4 py-2">OBSERVA√á√ïES</h2>
  <p>‚Ä¢ Validade: 15 dias ap√≥s envio.</p>
  <p>‚Ä¢ Entrega: A combinar.</p>
  <p>‚Ä¢ Pagamento: 50% na assinatura e 50% na entrega.</p>
</section>

<!-- CONSIDERA√á√ïES -->
<section class="p-4 md:p-6">
  <h2 class="bg-cinza text-vinho font-bold px-4 py-2">CONSIDERA√á√ïES FINAIS</h2>
  <p class="mt-2">Prezado(a) Sr.(a),</p>
  <p class="mt-2">
    A Pena Planejados agradece a oportunidade de apresentar este or√ßamento e permanece √† disposi√ß√£o.
  </p>
  <p class="mt-6 text-center font-bold text-vinho">
    Eben√©zer at√© aqui nos ajudou o Senhor (1 Sm 7:12)
  </p>
</section>

<!-- BOT√ïES -->
<div class="nao-imprimir flex flex-col md:flex-row justify-center gap-3 p-4 md:p-6">
  <button onclick="gerarPDF()" class="bg-green-600 text-white px-4 py-2 rounded">Gerar PDF</button>
  <button onclick="window.print()" class="bg-blue-600 text-white px-4 py-2 rounded">Imprimir</button>
  <button onclick="compartilhar()" class="bg-emerald-600 text-white px-4 py-2 rounded">Enviar WhatsApp</button>
</div>

</div>

<script>
dataAtual.innerText = new Date().toLocaleDateString('pt-BR')
let pdfBlob = null

function addLinha(){
  const tr=document.createElement('tr')
  tr.innerHTML=`
    <td class="border p-2"><input class="campo w-full border p-1"></td>
    <td class="border p-2"><input type="number" value="1" class="campo w-full border p-1 qtd"></td>
    <td class="border p-2"><input type="number" step="0.01" class="campo w-full border p-1 vista"></td>
    <td class="border p-2"><input type="number" step="0.01" class="campo w-full border p-1 prazo"></td>
    <td class="border p-2 text-center nao-imprimir">
      <button onclick="this.closest('tr').remove();calc()" class="text-red-600">‚úñ</button>
    </td>`
  itens.appendChild(tr)
  tr.querySelectorAll('input').forEach(i=>i.oninput=calc)
}

function calc(){
  let v=0,p=0
  document.querySelectorAll('#itens tr').forEach(tr=>{
    const q=+tr.querySelector('.qtd').value||0
    v+=q*(+tr.querySelector('.vista').value||0)
    p+=q*(+tr.querySelector('.prazo').value||0)
  })
  totalVista.innerText=v.toLocaleString('pt-BR',{style:'currency',currency:'BRL'})
  totalPrazo.innerText=p.toLocaleString('pt-BR',{style:'currency',currency:'BRL'})
}

async function gerarPDF(){
  document.querySelectorAll('.campo').forEach(c=>c.disabled=true)
  pdfBlob = await html2pdf().from(orcamento).outputPdf('blob')
  html2pdf().from(orcamento).save('orcamento-pena-planejados.pdf')
}

async function compartilhar(){
  if (!pdfBlob) {
    alert('Gere o PDF primeiro.')
    return
  }

  const file = new File([pdfBlob], 'orcamento-pena-planejados.pdf', { type: 'application/pdf' })

  if (navigator.canShare && navigator.canShare({ files: [file] })) {
    navigator.share({
      title: 'Or√ßamento Pena Planejados',
      files: [file]
    })
  } else {
    alert('Seu navegador n√£o suporta envio direto. O PDF ser√° baixado para envio manual.')
  }
}

addLinha()
</script>

</body>
</html>